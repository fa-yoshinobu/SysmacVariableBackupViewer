<Window x:Class="SysmacXmlViewer.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="SysmacVariableBackupViewer Ver.1.01" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        FontFamily="Yu Gothic UI, Meiryo, Microsoft YaHei, SimSun, sans-serif">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- ヘッダー情報 -->
        <GroupBox Grid.Row="0" Header="Project Information" Margin="10,5,10,5" Padding="10">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Project Name: " FontWeight="Bold" Foreground="#2E2E2E"/>
                <TextBlock Text="{Binding ProjectInfo.Name}" Margin="5,0" Foreground="#4A4A4A"/>
                <TextBlock Text="Device: " FontWeight="Bold" Foreground="#2E2E2E" Margin="20,0,0,0"/>
                <TextBlock Text="{Binding ProjectInfo.DeviceModelFull}" Margin="5,0" Foreground="#4A4A4A"/>
                <TextBlock Text="Version: " FontWeight="Bold" Foreground="#2E2E2E" Margin="20,0,0,0"/>
                <TextBlock Text="{Binding ProjectInfo.UnitVersion}" Margin="5,0" Foreground="#4A4A4A"/>
            </StackPanel>
        </GroupBox>
        
        <!-- ツールバー -->
        <ToolBar Grid.Row="1" Background="#F8F8F8" BorderBrush="#DDDDDD" BorderThickness="0,0,0,1">
            <Button Content="Load File" Command="{Binding LoadFileCommand}" 
                    Margin="2" Padding="8,4" Background="#F0F0F0" BorderBrush="#CCCCCC" BorderThickness="1"/>
            <Separator/>
            <Button Content="Export CSV" Command="{Binding ExportCsvCommand}" 
                    Margin="2" Padding="8,4" Background="#F0F0F0" BorderBrush="#CCCCCC" BorderThickness="1"/>
            <Separator/>
            <TextBlock Text="Filter:" VerticalAlignment="Center" FontWeight="Bold" Foreground="#2E2E2E"/>
            <TextBox Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}" Width="200" Margin="5,0" Padding="5,2"/>
            <TextBlock Text="Data Type:" VerticalAlignment="Center" FontWeight="Bold" Foreground="#2E2E2E" Margin="10,0,0,0"/>
            <ComboBox ItemsSource="{Binding AvailableDataTypes}" 
                      SelectedItem="{Binding SelectedDataType, UpdateSourceTrigger=PropertyChanged}" 
                      Width="120" Margin="5,0" Padding="5,2"/>
            <Button Content="Clear Filters" Command="{Binding ClearFiltersCommand}" 
                    Margin="2" Padding="8,4" Background="#F0F0F0" BorderBrush="#CCCCCC" BorderThickness="1"/>
        </ToolBar>
        
        <!-- 統計情報 -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="10,5,10,5">
            <TextBlock Text="Total Variables: " FontWeight="Bold" Foreground="#2E2E2E"/>
            <TextBlock Text="{Binding TotalVariables}" Margin="5,0" Foreground="#4A4A4A"/>
            <TextBlock Text="Displayed: " FontWeight="Bold" Foreground="#2E2E2E" Margin="20,0,0,0"/>
            <TextBlock Text="{Binding FilteredVariablesCount}" Margin="5,0" Foreground="#4A4A4A"/>
        </StackPanel>
        
        <!-- 変数リスト -->
        <DataGrid Grid.Row="3" ItemsSource="{Binding FilteredVariables}" 
                  AutoGenerateColumns="False" CanUserAddRows="False"
                  GridLinesVisibility="Horizontal" HeadersVisibility="Column"
                  AlternatingRowBackground="#F9F9F9"
                  SelectionMode="Extended" SelectionUnit="CellOrRowHeader"
                  IsReadOnly="False"
                  Margin="10,0,10,10"
                  FontFamily="Yu Gothic UI, Meiryo, Microsoft YaHei, SimSun, sans-serif"
                  KeyDown="DataGrid_KeyDown"
                  EnableRowVirtualization="True"
                  EnableColumnVirtualization="True"
                  VirtualizingPanel.IsVirtualizing="True"
                  VirtualizingPanel.VirtualizationMode="Recycling"
                  ScrollViewer.IsDeferredScrollingEnabled="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Variable Name" Binding="{Binding DisplayName}" Width="400" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontFamily" Value="Yu Gothic UI, Meiryo, Microsoft YaHei, SimSun, sans-serif"/>
                            <Setter Property="TextWrapping" Value="Wrap"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Data Type" Binding="{Binding DataTypeDisplayName}" Width="120" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontFamily" Value="Yu Gothic UI, Meiryo, Microsoft YaHei, SimSun, sans-serif"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="350" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontFamily" Value="Consolas, Courier New, monospace"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Converted Value" Binding="{Binding ConvertedValueDisplay}" Width="300" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontFamily" Value="Yu Gothic UI, Meiryo, Microsoft YaHei, SimSun, sans-serif"/>
                            <Setter Property="TextWrapping" Value="Wrap"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Offset" Binding="{Binding Offset}" Width="80" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontFamily" Value="Consolas, Courier New, monospace"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Group" Binding="{Binding GroupName}" Width="150" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontFamily" Value="Yu Gothic UI, Meiryo, Microsoft YaHei, SimSun, sans-serif"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Array Index" Binding="{Binding ArrayIndex}" Width="100" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontFamily" Value="Consolas, Courier New, monospace"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid>
        
        <!-- ステータスバー -->
        <StatusBar Grid.Row="4" Background="#F0F0F0">
            <StatusBarItem>
                <TextBlock Text="{Binding CurrentFilePath}" FontSize="11"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Text="Ver.1.01" FontSize="11" FontWeight="Bold" Foreground="#2E2E2E"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window> 